<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>La Mia Stanza - Libreria v1.1</title>
  <style>
    :root{
      --bg:#070a0f;
      --panel:rgba(16,20,28,.85);
      --text:#e9eef6;
      --muted:#9aa8bd;
      --line:rgba(255,255,255,.12);
      --accent:#7aa2ff;
      --ok:#6ee7b7;     /* Letti */
      --warn:#fbbf24;   /* In lettura */
      --info:#38bdf8;   /* Da leggere (Posseduti) */
      --wish:#f472b6;   /* Da acquistare (Wishlist) */
      --bad:#fb7185;
      --shadow:0 20px 60px rgba(0,0,0,.6);
      --radius:16px;
      --font:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    }

    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--font); color:var(--text); background:var(--bg);
      min-height:100vh; overflow-x:hidden;
    }

    /* Background decorativo per la modalitÃ  lista */
    body:not(.is-room)::before{
      content:""; position:fixed; inset:0; z-index:-1;
      background: radial-gradient(circle at 50% 0%, #1e293b 0%, #070a0f 60%);
    }

    .wrap{ max-width:1200px; margin:0 auto; padding:20px 16px 80px; position:relative; z-index:1; }

    /* HEADER */
    header{ display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:20px; }
    .title h1{ margin:0; font-size:24px; letter-spacing:-0.5px; }
    .title p{ margin:4px 0 0; color:var(--muted); font-size:13px; }

    /* BOTTONI E UI */
    .btn{
      border:1px solid var(--line); background:rgba(255,255,255,.05); color:var(--text);
      padding:8px 14px; border-radius:10px; cursor:pointer; font-weight:600; font-size:13px;
      transition:all .2s;
    }
    .btn:hover{ background:rgba(255,255,255,.1); transform:translateY(-1px); }
    .btn.primary{ background:rgba(122,162,255,.2); border-color:rgba(122,162,255,.4); color:#bfdbfe; }
    .btn.danger{ color:var(--bad); border-color:rgba(251,113,133,.3); background:rgba(251,113,133,.05); }

    .view-toggle{ display:flex; background:rgba(0,0,0,.3); border-radius:10px; padding:2px; border:1px solid var(--line); }
    .view-toggle button{
      border:0; background:transparent; color:var(--muted); padding:6px 14px; cursor:pointer; font-weight:600; font-size:13px; border-radius:8px;
    }
    .view-toggle button.on{ background:var(--panel); color:var(--text); box-shadow:0 2px 4px rgba(0,0,0,.2); }

    /* PANNELLI */
    .panel{
      border:1px solid var(--line); background:var(--panel); border-radius:var(--radius);
      box-shadow:var(--shadow); backdrop-filter:blur(12px); margin-bottom:16px;
      position: relative; /* Necessario per il contesto */
    }
    .panel.pad{ padding:20px; }
    
    /* FIX CRITICO: Overflow visible per permettere alla dropdown di uscire */
    .panel.formpanel{ overflow:visible; z-index: 100; }

    /* FORM & INPUT */
    .grid-form{ display:grid; grid-template-columns: 2fr 1fr 0.5fr; gap:12px; align-items:end; }
    @media (max-width: 700px){ .grid-form{ grid-template-columns:1fr; } }

    label{ display:block; font-size:11px; color:var(--muted); margin-bottom:6px; text-transform:uppercase; letter-spacing:0.5px; }
    input, select, textarea{
      width:100%; border:1px solid var(--line); background:rgba(0,0,0,.3); color:var(--text);
      border-radius:10px; padding:10px 12px; outline:none; font-size:14px;
      transition: border-color .2s;
    }
    input:focus, select:focus, textarea:focus{ border-color:var(--accent); }
    textarea{ min-height:70px; resize:vertical; }

    /* DROPDOWN DI RICERCA - FIX Z-INDEX */
    .lookup-wrap{ position:relative; }
    .dropdown{
      position:absolute; top:calc(100% + 6px); left:0; right:0;
      background:#11151d; border:1px solid var(--line); border-radius:12px;
      z-index:99999; /* Altissimo per stare sopra a tutto */
      box-shadow:0 10px 40px rgba(0,0,0,.9);
      display:none; overflow:hidden;
    }
    .dropdown.on{ display:block; }
    .dd-item{
      display:flex; gap:10px; padding:10px; border-bottom:1px solid rgba(255,255,255,.05);
      cursor:pointer; align-items:center;
    }
    .dd-item:hover{ background:rgba(255,255,255,.05); }
    .dd-item:last-child{ border-bottom:0; }
    .dd-img{ width:32px; height:48px; background:#222; border-radius:4px; object-fit:cover; }
    .dd-info{ flex:1; min-width:0; }
    .dd-title{ font-weight:600; font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .dd-sub{ color:var(--muted); font-size:12px; }

    /* LISTA CARD */
    .list-grid{ display:grid; gap:10px; }
    .card{
      display:flex; gap:14px; padding:12px; border-radius:14px;
      border:1px solid var(--line); background:rgba(255,255,255,.02);
      cursor:pointer; transition: background .2s; align-items:center;
    }
    .card:hover{ background:rgba(255,255,255,.06); }
    .c-img{ width:40px; height:60px; border-radius:6px; background:#222; object-fit:cover; border:1px solid var(--line); }
    .c-main{ flex:1; min-width:0; }
    .c-title{ font-weight:700; font-size:15px; margin-bottom:2px; color:#fff; }
    .c-auth{ font-size:13px; color:var(--muted); }
    .badge{
      font-size:11px; padding:4px 8px; border-radius:20px; font-weight:600;
      border:1px solid transparent;
    }
    .badge.read{ color:var(--ok); background:rgba(110,231,183,.1); border-color:rgba(110,231,183,.2); }
    .badge.reading{ color:var(--warn); background:rgba(251,191,36,.1); border-color:rgba(251,191,36,.2); }
    .badge.to_read{ color:var(--info); background:rgba(56,189,248,.1); border-color:rgba(56,189,248,.2); }
    .badge.wishlist{ color:var(--wish); background:rgba(244,114,182,.1); border-color:rgba(244,114,182,.2); }

    /* STANZA INTERATTIVA */
    .scene-wrap{
      position:relative; width:100%; aspect-ratio:16/8;
      background:#000; border-radius:18px; overflow:hidden;
      box-shadow:inset 0 0 100px rgba(0,0,0,.8);
      border:1px solid var(--line);
    }
    /* Sfondo Stanza - Usa un placeholder CSS se manca l'immagine */
    .scene-bg{
      width:100%; height:100%; object-fit:cover; opacity:0.6;
      background: radial-gradient(circle at 50% 100%, #2a2018 0%, #050505 80%);
      transition: opacity 1s;
    }
    .scene-bg.loaded{ opacity:1; }

    /* Contenitori Zone */
    .zone{ position:absolute; border:0px dashed rgba(255,255,255,.2); pointer-events:none; }
    
    /* Definisco le zone "logiche" sullo schermo */
    /* Libreria Alta (Read) */
    .zone-read { top: 15%; left: 10%; width: 80%; height: 25%; display:flex; align-items:flex-end; justify-content:center; gap:4px; }
    
    /* Libreria Bassa (To Read - Posseduti) */
    .zone-toread { top: 45%; left: 10%; width: 30%; height: 15%; display:flex; align-items:flex-end; justify-content:flex-start; gap:2px; flex-wrap:wrap; }
    
    /* Tavolo (Reading) - In primo piano */
    .zone-reading { bottom: 10%; left: 35%; width: 30%; height: 20%; z-index:10; display:flex; align-items:center; justify-content:center; gap:15px; perspective: 800px; }
    
    /* Wishlist (Magari un angolo o un foglietto) */
    .zone-wish { bottom: 20%; right: 10%; width: 20%; height: 20%; display:grid; grid-template-columns:repeat(3,1fr); gap:5px; transform: rotate(-5deg); opacity:0.8; }

    /* Libri nella stanza */
    .r-book{
      position:relative; cursor:pointer; pointer-events:auto;
      box-shadow:2px 4px 10px rgba(0,0,0,.6);
      transition:transform .2s, filter .2s;
    }
    .r-book:hover{ transform:scale(1.1) translateY(-5px); filter:brightness(1.2); z-index:100; }
    .r-book img{ width:100%; height:100%; object-fit:cover; border-radius:2px; }
    .r-book .spine{
        width:100%; height:100%; background:linear-gradient(90deg, #333, #555, #333);
        color:#fff; writing-mode:vertical-rl; font-size:9px; text-align:center; overflow:hidden; border-radius:2px;
    }

    /* Stili specifici per stato */
    /* Letti: Verticali piccoli */
    .zone-read .r-book { width:24px; height:80px; margin-left:1px; }
    
    /* Da leggere: Orizzontali impilati o verticali stretti */
    .zone-toread .r-book { width:22px; height:75px; margin-left:-2px; transform: rotate(0deg); }

    /* In lettura: Aperti o grandi sul tavolo */
    .zone-reading .r-book { 
        width:90px; height:130px; 
        box-shadow: 0 20px 50px rgba(0,0,0,.8);
        transform: rotateX(10deg); /* Leggera prospettiva */
    }

    /* Wishlist: Piccoli francobolli */
    .zone-wish .r-book { width:30px; height:45px; opacity:0.7; }

    /* MODAL FOCUS (ZOOM) */
    .overlay{
      position:fixed; inset:0; background:rgba(0,0,0,.85); z-index:20000;
      display:none; align-items:center; justify-content:center; padding:20px;
      backdrop-filter:blur(5px);
    }
    .overlay.on{ display:flex; }
    .focus-card{
      width:100%; max-width:500px; background:#161b24; border:1px solid var(--line);
      border-radius:20px; padding:24px; position:relative; box-shadow:0 50px 100px #000;
    }
    .fc-grid{ display:grid; grid-template-columns:120px 1fr; gap:20px; }
    .fc-cover{ width:100%; aspect-ratio:2/3; object-fit:cover; border-radius:10px; background:#000; }
    .fc-meta h2{ margin:0 0 6px; font-size:20px; line-height:1.2; }
    .fc-meta p{ color:var(--muted); margin:0 0 16px; font-size:14px; }
    
    .fc-actions{ display:flex; flex-wrap:wrap; gap:8px; margin-top:20px; padding-top:20px; border-top:1px solid var(--line); }
    .chip-status{ display:inline-block; font-size:12px; padding:4px 10px; border-radius:99px; border:1px solid currentColor; margin-bottom:12px; }

    .toast{
      position:fixed; bottom:20px; right:20px; background:#fff; color:#000;
      padding:12px 20px; border-radius:10px; font-weight:600; z-index:30000;
      transform:translateY(100px); transition:transform .3s;
    }
    .toast.on{ transform:translateY(0); }

    /* Helper utility */
    .hidden{ display:none!important; }
    .is-room .room-only{ display:inline-flex; }
    .is-room .list-only{ display:none; }
    body:not(.is-room) .room-only{ display:none; }
    
    #editionsModal { z-index: 110000; /* Sopra a tutto */ }
  </style>
</head>
<body>

<div class="wrap">
  <header>
    <div class="title">
      <h1>La Mia Libreria</h1>
      <p>Gestione Locale v1.1 â€¢ Focus & Scaffali</p>
    </div>
    <div style="display:flex; gap:10px;">
      <div class="view-toggle">
        <button id="btnList" class="on">Lista</button>
        <button id="btnRoom">Stanza</button>
      </div>
      <button class="btn room-only primary" id="btnQuickAdd">ï¼‹ Aggiungi</button>
      <button class="btn list-only" id="btnExport">ðŸ’¾ Backup</button>
    </div>
  </header>

  <div class="panel pad formpanel list-only" id="formPanel">
    <div class="grid-form">
      <div class="lookup-wrap">
        <label>Cerca Libro (OpenLibrary)</label>
        <input id="inpSearch" placeholder="Titolo, autore..." autocomplete="off">
        <div class="dropdown" id="dropdown">
          <div id="ddList"></div>
        </div>
      </div>
      
      <div>
        <label>Stato</label>
        <select id="inpStatus">
          <option value="reading">ðŸ“– In Lettura (Tavolo)</option>
          <option value="read">âœ… Letto (Scaffale Alto)</option>
          <option value="to_read">ðŸ“š Da leggere (Scaffale Basso)</option>
          <option value="wishlist">ðŸ’¸ Da acquistare (Wishlist)</option>
        </select>
      </div>

      <div>
        <label>&nbsp;</label>
        <button class="btn primary" style="width:100%" id="btnSave">Salva</button>
      </div>
    </div>
    <div style="margin-top:10px; display:flex; gap:10px;">
        <input id="inpComment" placeholder="Note / Recensione..." style="flex:1">
        <select id="inpRating" style="width:80px">
            <option value="">Voto</option>
            <option value="5">5 â˜…</option>
            <option value="4">4 â˜…</option>
            <option value="3">3 â˜…</option>
            <option value="2">2 â˜…</option>
            <option value="1">1 â˜…</option>
        </select>
        <button class="btn ghost" id="btnClear">Pulisci</button>
    </div>
  </div>

  <div class="list-grid list-only" id="listView"></div>

  <div class="panel pad room-only hidden" id="roomPanel">
    <div style="margin-bottom:10px; font-size:12px; color:var(--muted); display:flex; justify-content:space-between;">
        <span>Tavolo: In lettura â€¢ Scaffali: Letti/Da Leggere â€¢ Angolo: Wishlist</span>
        <span id="roomCount">0 libri</span>
    </div>
    <div class="scene-wrap">
        <img src="./assets/room.jpg" class="scene-bg" id="roomBg" alt="Stanza" onerror="this.style.display='none'">
        
        <div class="zone zone-read" id="shelfRead" title="Letti"></div>
        <div class="zone zone-toread" id="shelfToRead" title="Da Leggere (Miei)"></div>
        <div class="zone zone-reading" id="tableReading" title="In Lettura"></div>
        <div class="zone zone-wish" id="areaWish" title="Vorrei Comprare"></div>
    </div>
  </div>

</div>

<div class="overlay" id="focusOverlay">
  <div class="focus-card">
    <button class="btn small" style="position:absolute; top:15px; right:15px;" id="btnCloseFocus">âœ•</button>
    <div class="fc-grid">
      <img src="" class="fc-cover" id="fcCover">
      <div class="fc-meta">
        <span class="chip-status" id="fcStatus">Letto</span>
        <h2 id="fcTitle">Titolo</h2>
        <p id="fcAuthor">Autore</p>
        <div style="font-size:13px; color:var(--muted); line-height:1.4;" id="fcComment"></div>
        <div style="margin-top:10px; font-weight:bold; color:var(--accent);" id="fcRating"></div>
      </div>
    </div>
    
    <div class="fc-actions">
        <button class="btn" id="btnCycleStatus">Cambia Stato</button>
        <button class="btn danger" id="btnDelete">Elimina</button>
        <div style="flex:1"></div>
        <button class="btn" onclick="openService('amazon')">ðŸ›’ Amazon/Kindle</button>
        <button class="btn" onclick="openService('audible')">ðŸŽ§ Audible</button>
        <button class="btn" onclick="openService('feltrinelli')">ðŸ‡®ðŸ‡¹ Feltrinelli</button>
    </div>
  </div>
</div>

<div class="toast" id="toast">Messaggio</div>

<script>
// --- CONFIGURAZIONE & DATI ---
const LS_KEY = "libreria_v1_1";
let books = JSON.parse(localStorage.getItem(LS_KEY) || "[]");
let editingId = null;
let currentFocusId = null;

// --- DOM ELEMENTS ---
const $ = (id) => document.getElementById(id);
const views = { list: $('listView'), room: $('roomPanel'), form: $('formPanel') };
const btns = { list: $('btnList'), room: $('btnRoom') };

// --- LOGICA DI NAVIGAZIONE ---
function setView(mode){
    document.body.classList.toggle('is-room', mode === 'room');
    views.list.classList.toggle('hidden', mode === 'room');
    views.form.classList.toggle('hidden', mode === 'room');
    views.room.classList.toggle('hidden', mode !== 'room');
    
    btns.list.classList.toggle('on', mode === 'list');
    btns.room.classList.toggle('on', mode === 'room');
    
    if(mode === 'list') renderList();
    if(mode === 'room') renderRoom();
}

$('btnList').onclick = () => setView('list');
$('btnRoom').onclick = () => setView('room');
$('btnQuickAdd').onclick = () => { setView('list'); $('inpSearch').focus(); };

// --- LOGICA DATI ---
function saveBook(book){
    if(book.id){
        const idx = books.findIndex(b => b.id === book.id);
        if(idx >= 0) books[idx] = { ...books[idx], ...book };
    } else {
        book.id = crypto.randomUUID();
        book.addedAt = new Date().toISOString();
        books.unshift(book);
    }
    localStorage.setItem(LS_KEY, JSON.stringify(books));
    showToast("Salvato!");
    renderList();
    resetForm();
}

function deleteBook(id){
    if(!confirm("Eliminare definitivamente?")) return;
    books = books.filter(b => b.id !== id);
    localStorage.setItem(LS_KEY, JSON.stringify(books));
    closeFocus();
    if(document.body.classList.contains('is-room')) renderRoom(); else renderList();
    showToast("Eliminato.");
}

// --- LOGICA RICERCA (OPEN LIBRARY) ---
let debounceTimer;
$('inpSearch').addEventListener('input', (e) => {
    const q = e.target.value.trim();
    if(q.length < 3) { $('dropdown').classList.remove('on'); return; }
    
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(() => doSearch(q), 400);
});

async function doSearch(query){
    const res = await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(query)}&limit=6`);
    const data = await res.json();
    
    const html = data.docs.map(d => {
        const cover = d.cover_i ? `https://covers.openlibrary.org/b/id/${d.cover_i}-S.jpg` : '';
        // Cerca di dare prioritÃ  alle edizioni italiane se ci sono info (molto basic)
        return `
        <div class="dd-item" onclick="selectBook('${d.title.replace(/'/g, "\\'")}', '${(d.author_name?.[0]||"").replace(/'/g, "\\'")}', '${cover}')">
            ${cover ? `<img src="${cover}" class="dd-img">` : '<div class="dd-img"></div>'}
            <div class="dd-info">
                <div class="dd-title">${d.title}</div>
                <div class="dd-sub">${d.author_name?.[0] || 'Autore sconosciuto'}</div>
            </div>
        </div>`;
    }).join('');
    
    $('ddList').innerHTML = html;
    $('dropdown').classList.add('on');
}

window.selectBook = (title, author, cover) => {
    $('inpSearch').value = title;
    $('dropdown').classList.remove('on');
    // Salviamo temp i dati
    window.tempBook = { title, author, cover };
};

// --- GESTIONE FORM ---
$('btnSave').onclick = () => {
    const title = $('inpSearch').value;
    if(!title) return alert("Inserisci almeno un titolo");
    
    const newBook = {
        id: editingId,
        title: title,
        author: window.tempBook?.author || "Sconosciuto",
        cover: window.tempBook?.cover || "",
        status: $('inpStatus').value,
        comment: $('inpComment').value,
        rating: $('inpRating').value,
        ...window.tempBook
    };
    saveBook(newBook);
};

$('btnClear').onclick = resetForm;

function resetForm(){
    $('inpSearch').value = "";
    $('inpComment').value = "";
    $('inpRating').value = "";
    $('dropdown').classList.remove('on');
    editingId = null;
    window.tempBook = null;
}

// --- RENDER LISTA ---
function renderList(){
    const el = $('listView');
    el.innerHTML = books.map(b => `
        <div class="card" onclick="openFocus('${b.id}')">
            <img src="${b.cover || ''}" class="c-img" onerror="this.style.backgroundColor='#333'">
            <div class="c-main">
                <div class="c-title">${b.title}</div>
                <div class="c-auth">${b.author}</div>
            </div>
            <div class="badge ${b.status}">${statusLabel(b.status)}</div>
        </div>
    `).join('');
    if(books.length === 0) el.innerHTML = `<div style="padding:20px; color:var(--muted); text-align:center">Nessun libro. Aggiungine uno!</div>`;
}

function statusLabel(s){
    const map = { reading: "In Lettura", read: "Letto", to_read: "Da Leggere", wishlist: "Wishlist" };
    return map[s] || s;
}

// --- RENDER STANZA (LOGICA MIGLIORATA) ---
function renderRoom(){
    // Pulisci scaffali
    ['shelfRead', 'shelfToRead', 'tableReading', 'areaWish'].forEach(id => $(id).innerHTML = '');
    
    // Filtra e limita i libri per zona (Come richiesto: pochi sul tavolo, tanti sugli scaffali)
    const reading = books.filter(b => b.status === 'reading').slice(0, 5);
    const read = books.filter(b => b.status === 'read').slice(0, 20);
    const toRead = books.filter(b => b.status === 'to_read').slice(0, 20);
    const wishlist = books.filter(b => b.status === 'wishlist').slice(0, 10);
    
    // Funzione helper per creare il libro DOM
    const createBookEl = (b) => {
        const div = document.createElement('div');
        div.className = 'r-book';
        div.onclick = () => openFocus(b.id);
        div.title = b.title;
        if(b.cover) {
            div.innerHTML = `<img src="${b.cover}">`;
        } else {
            div.innerHTML = `<div class="spine">${b.title}</div>`;
        }
        return div;
    };

    reading.forEach(b => $('tableReading').appendChild(createBookEl(b)));
    read.forEach(b => $('shelfRead').appendChild(createBookEl(b)));
    toRead.forEach(b => $('shelfToRead').appendChild(createBookEl(b)));
    wishlist.forEach(b => $('areaWish').appendChild(createBookEl(b)));
    
    $('roomCount').textContent = `${books.length} Libri totali`;
}

// --- FOCUS & AZIONI ---
window.openFocus = (id) => {
    const b = books.find(x => x.id === id);
    if(!b) return;
    currentFocusId = id;
    
    $('fcTitle').innerText = b.title;
    $('fcAuthor').innerText = b.author;
    $('fcCover').src = b.cover || '';
    $('fcStatus').innerText = statusLabel(b.status);
    $('fcStatus').className = `chip-status ${b.status}`;
    $('fcStatus').style.color = getComputedStyle(document.documentElement).getPropertyValue(`--${b.status === 'reading' ? 'warn' : (b.status==='read'?'ok':(b.status==='wishlist'?'wish':'info'))}`);
    $('fcStatus').style.borderColor = $('fcStatus').style.color;
    
    $('fcComment').innerText = b.comment || "Nessuna recensione.";
    $('fcRating').innerText = b.rating ? "â˜…".repeat(b.rating) : "";
    
    $('focusOverlay').classList.add('on');
};

$('btnCloseFocus').onclick = closeFocus;
function closeFocus(){ $('focusOverlay').classList.remove('on'); currentFocusId = null; }

$('btnCycleStatus').onclick = () => {
    if(!currentFocusId) return;
    const b = books.find(x => x.id === currentFocusId);
    // Ciclo logico: Wishlist -> Da Leggere -> In Lettura -> Letto
    if(b.status === 'wishlist') b.status = 'to_read';
    else if(b.status === 'to_read') b.status = 'reading';
    else if(b.status === 'reading') b.status = 'read';
    else b.status = 'wishlist'; // Loop
    
    saveBook(b); // Salva e aggiorna UI
    openFocus(b.id); // Ricarica dati nel modal
};

$('btnDelete').onclick = () => { if(currentFocusId) deleteBook(currentFocusId); };

// --- SERVIZI ESTERNI (Stub) ---
window.openService = (type) => {
    if(!currentFocusId) return;
    const b = books.find(x => x.id === currentFocusId);
    const q = encodeURIComponent(b.title + " " + b.author);
    
    if(type === 'amazon') window.open(`https://www.amazon.it/s?k=${q}&i=stripbooks`, '_blank');
    if(type === 'audible') window.open(`https://www.audible.it/search?keywords=${q}`, '_blank');
    if(type === 'feltrinelli') window.open(`https://www.lafeltrinelli.it/ricerca?q=${q}`, '_blank');
};

// --- UTILS ---
function showToast(msg){
    const t = $('toast');
    t.innerText = msg;
    t.classList.add('on');
    setTimeout(()=>t.classList.remove('on'), 2000);
}

$('btnExport').onclick = () => {
    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(books));
    const a = document.createElement('a');
    a.href = dataStr; a.download = "libreria_backup.json";
    a.click();
};

// Init
renderList();
</script>
</body>
</html>
